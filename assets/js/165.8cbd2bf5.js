(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{645:function(a,t,e){"use strict";e.r(t);var r=e(56),s=Object(r.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"array-formulas"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#array-formulas"}},[a._v("#")]),a._v(" Array formulas")]),a._v(" "),e("p",[a._v("Use array formulas to perform an operation (or call a function) on multiple cells at a time.")]),a._v(" "),e("h2",{attrs:{id:"about-arrays"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#about-arrays"}},[a._v("#")]),a._v(" About arrays")]),a._v(" "),e("p",[a._v("In HyperFormula, an array can be:")]),a._v(" "),e("ul",[e("li",[a._v("A range of cell addresses (e.g. "),e("code",[a._v("A1:A10")]),a._v(")")]),a._v(" "),e("li",[a._v("An "),e("strong",[a._v("ad-hoc array")]),a._v(": an input array with no ground-truth range that defines the values (e.g. "),e("code",[a._v("{1,3,5}")]),a._v(")")]),a._v(" "),e("li",[a._v("A result of an arithmetic operation (e.g. "),e("code",[a._v("5*A1:B5")]),a._v(")")]),a._v(" "),e("li",[a._v("A result of a function (e.g. "),e("code",[a._v("=ARRAYFORMULA(ARRAY_CONSTRAIN(A2:E5,2,2))")]),a._v(")")])]),a._v(" "),e("p",[a._v("An array is inherently a two-dimensional object.")]),a._v(" "),e("p",[e("code",[a._v("1")]),a._v("x"),e("code",[a._v("1")]),a._v(" arrays are treated as single, zero-dimensional values ("),e("strong",[a._v("scalars")]),a._v(").")]),a._v(" "),e("h2",{attrs:{id:"array-arithmetic-mode"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#array-arithmetic-mode"}},[a._v("#")]),a._v(" Array arithmetic mode")]),a._v(" "),e("p",[a._v("To use array formulas in HyperFormula, you need to enable the "),e("strong",[a._v("array arithmetic mode")]),a._v(".")]),a._v(" "),e("p",[a._v("You can enable the array arithmetic mode:")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode-locally"}},[a._v("Locally")]),a._v(" (for an individual function or operation)")]),a._v(" "),e("li",[e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode-globally"}},[a._v("Globally")]),a._v(" (for your HyperFormula instance)")])]),a._v(" "),e("h3",{attrs:{id:"enabling-the-array-arithmetic-mode-locally"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enabling-the-array-arithmetic-mode-locally"}},[a._v("#")]),a._v(" Enabling the array arithmetic mode locally")]),a._v(" "),e("p",[a._v("To enable the array arithmetic mode once, within a particular function or formula, use the "),e("code",[a._v("ARRAYFORMULA")]),a._v(" function:")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[a._v("Syntax")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("Example")])])]),a._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("ARRAYFORMULA(your_array_formula)")])]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("=ARRAYFORMULA(A2:A5*B2:B5)")])])]),a._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("ARRAYFORMULA(YOUR_FUNCTION(your_array_formula))")])]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("=ARRAYFORMULA(ISEVEN(A2:A5*10))")])])])])]),a._v(" "),e("h3",{attrs:{id:"enabling-the-array-arithmetic-mode-globally"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enabling-the-array-arithmetic-mode-globally"}},[a._v("#")]),a._v(" Enabling the array arithmetic mode globally")]),a._v(" "),e("p",[a._v("To enable the array arithmetic mode by default, everywhere in your HyperFormula instance:")]),a._v(" "),e("ul",[e("li",[a._v("In your HyperFormula "),e("RouterLink",{attrs:{to:"/api/interfaces/configparams.html#usearrayarithmetic"}},[a._v("configuration")]),a._v(", set the "),e("code",[a._v("useArrayArithmetic")]),a._v(" option to "),e("code",[a._v("true")]),a._v(".")],1)]),a._v(" "),e("p",[a._v("With the array arithmetic mode enabled globally, you can operate on arrays without using the "),e("code",[a._v("ARRAYFORMULA")]),a._v(" function:")]),a._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("B2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("B5")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ISEVEN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),e("h2",{attrs:{id:"array-features"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#array-features"}},[a._v("#")]),a._v(" Array features")]),a._v(" "),e("p",[a._v("Thanks to HyperFormula's built-in array features, you can:")]),a._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#operating-on-arrays"}},[a._v("Operate on arrays")]),a._v(" just like on "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalars")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#passing-arrays-to-scalar-functions"}},[a._v("Pass arrays to functions")]),a._v(" that accept "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalars")])]),a._v(" "),e("li",[e("a",{attrs:{href:"#broadcasting"}},[a._v("Broadcast")]),a._v(" smaller input arrays across larger output areas")])]),a._v(" "),e("p",[a._v("You can also:")]),a._v(" "),e("ul",[e("li",[a._v("Use the "),e("code",[a._v("FILTER")]),a._v(" function to "),e("a",{attrs:{href:"#filtering-an-array"}},[a._v("filter an array")]),a._v(", based on boolean arrays")]),a._v(" "),e("li",[a._v("Use the "),e("code",[a._v("ARRAY_CONSTRAIN")]),a._v(" function to "),e("a",{attrs:{href:"#constraining-an-array-s-size"}},[a._v("constrain an array's size")])])]),a._v(" "),e("h3",{attrs:{id:"operating-on-arrays"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#operating-on-arrays"}},[a._v("#")]),a._v(" Operating on arrays")]),a._v(" "),e("p",[a._v("You can operate on arrays just like on single values.")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is enabled, each output array value is the result of your operation on the corresponding input array value.")]),a._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ARRAYFORMULA")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("B2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("B5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// calculates:")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =A2*B2")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =A3*B3")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =A4*B4")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =A5*B5")]),a._v("\n")])])]),e("h3",{attrs:{id:"passing-arrays-to-scalar-functions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#passing-arrays-to-scalar-functions"}},[a._v("#")]),a._v(" Passing arrays to scalar functions")]),a._v(" "),e("p",[a._v("You can pass arrays to functions that would normally accept "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalars")]),a._v(" (thanks to HyperFormula's "),e("strong",[a._v("vectorization")]),a._v(" feature).")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is enabled, and you pass an array to a "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalar")]),a._v(" function, that function produces an array on the output as well.")]),a._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ARRAYFORMULA")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ISEVEN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// calculates:")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A2*10)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A3*10)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A4*10)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A5*10)")]),a._v("\n")])])]),e("h4",{attrs:{id:"broadcasting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#broadcasting"}},[a._v("#")]),a._v(" Broadcasting")]),a._v(" "),e("p",[a._v("If an input array has a dimension of "),e("code",[a._v("1")]),a._v(', it\'s automatically repeated ("broadcast") on that dimension to match the size of the output.')]),a._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ARRAYFORMULA")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("ISEVEN")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A2")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("A5")]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),e("span",{pre:!0,attrs:{class:"token constant"}},[a._v("B2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// calculates:")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A2*B2)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A3*B2)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A4*B2)")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// =ISEVEN(A5*B2)")]),a._v("\n")])])]),e("h3",{attrs:{id:"filtering-an-array"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#filtering-an-array"}},[a._v("#")]),a._v(" Filtering an array")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is enabled, you can filter an array, based on boolean arrays, using the "),e("code",[a._v("FILTER")]),a._v(" function:")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[a._v("Syntax")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("Example")])])]),a._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("FILTER(your_array, BoolArray1[; BoolArray2[; ...]]")])]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("=ARRAYFORMULA(FILTER(A2:A5*10), {1,0,0,1})")])])])])]),a._v(" "),e("h3",{attrs:{id:"constraining-an-array-s-size"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#constraining-an-array-s-size"}},[a._v("#")]),a._v(" Constraining an array's size")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is enabled, you can constrain the size of the output array, using the "),e("code",[a._v("ARRAY_CONSTRAIN")]),a._v(" function:")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[a._v("Syntax")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("Example")])])]),a._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("ARRAY_CONSTRAIN(your_array,height,width)")])]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("=ARRAYFORMULA(ARRAY_CONSTRAIN(A2:E5,2,2))")])])])])]),a._v(" "),e("p",[a._v("If your specified output array size is smaller than the input array size, only the corresponding top-left cells of the input array are taken into account.")]),a._v(" "),e("p",[a._v("If your specified output array size is larger or equal to the input array size, no change is made.")]),a._v(" "),e("h2",{attrs:{id:"array-rules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#array-rules"}},[a._v("#")]),a._v(" Array rules")]),a._v(" "),e("h3",{attrs:{id:"with-the-array-arithmetic-mode-enabled"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#with-the-array-arithmetic-mode-enabled"}},[a._v("#")]),a._v(" With the array arithmetic mode enabled")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is enabled, and you pass an array to a "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalar")]),a._v(" function, the following rules apply:")]),a._v(" "),e("ul",[e("li",[a._v("Array dimensions need to be consistent (e.g. every row needs to be of the same length).")]),a._v(" "),e("li",[a._v("If an input array value is missing (due to a difference in dimensions), the corresponding output array value is "),e("code",[a._v("#N/A")]),a._v(".")]),a._v(" "),e("li",[a._v("If a cell evaluates to an array, the array values are spilled into neighboring cells (unless the neighboring cells are already filled)."),e("br"),a._v("This behavior doesn't apply to ranges, which return the "),e("code",[a._v("#VALUE!")]),a._v(" error in this case.")]),a._v(" "),e("li",[a._v("If one of input array dimensions is "),e("code",[a._v("1")]),a._v(" ("),e("code",[a._v("1")]),a._v("x"),e("code",[a._v("n")]),a._v(" or "),e("code",[a._v("n")]),a._v("x"),e("code",[a._v("1")]),a._v("), the array is repeated, to match the output array dimensions.")])]),a._v(" "),e("h3",{attrs:{id:"with-the-array-arithmetic-mode-disabled"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#with-the-array-arithmetic-mode-disabled"}},[a._v("#")]),a._v(" With the array arithmetic mode disabled")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is disabled, and you pass an array to a "),e("a",{attrs:{href:"#about-arrays"}},[a._v("scalar")]),a._v(" function, the array is reduced to 1 element (usually the array's top-left value).")]),a._v(" "),e("p",[a._v("When the "),e("a",{attrs:{href:"#enabling-the-array-arithmetic-mode"}},[a._v("array arithmetic mode")]),a._v(" is disabled, and you operate on a range of width/height equal to "),e("code",[a._v("1")]),a._v(", the behavior depends on your array formula's location:")]),a._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[a._v("Your array formula's location")]),a._v(" "),e("th",{staticStyle:{"text-align":"left"}},[a._v("Behavior")])])]),a._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[a._v("In the same row as as one of the range's elements")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[a._v("Only that particular element is taken.")])]),a._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[a._v("Any other cell")]),a._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[a._v("#VALUE!")]),a._v(" error")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);